<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Cat Clicker App">
  <meta name="author" content="Karol Zyskowski">
  <title>Cat Clicker</title>
  <base target="_blank">
  <link rel="stylesheet" href="css/style.css">
  <script src="js/jquery-1.11.3.min.js"></script>
<body>
  <script>
      var cats = {
            "kittens" : [
              {
                "name" : "Ninni",
                "img"  : "img/kitten-1.jpg"
              },
              {
                "name" : "Hugo",
                "img"  : "img/kitten-2.jpg"
              },
              {
                "name" : "Nora",
                "img"  : "img/kitten-3.jpg"
              },
              {
                "name" : "Ridder",
                "img"  : "img/kitten-4.jpg"
              },
              {
                "name" : "Waldo",
                "img"  : "img/kitten-5.jpg"
              }
           ]
         };

      //

      document.body.innerHTML = '';

      var info = document.createElement('div');
      info.id = "info";
      document.body.appendChild(info);
      
      $('#info').prepend('<h2>Choose a cat from the list:</h2>');
      $('#info').append('<ul id="catNameList"></ul>');

      var display = document.createElement('div');
      display.id = "catshow";
      document.body.appendChild(display);

      var html_cat_name  = '<h2></h2>',
          html_cat_img   = '<img class="clicker" src=""/>',
          html_cat_click = '<p class="counter"></p>',
          html_list      = '<li>%data%</li>';

      $("#catshow").append('<div id="">' + html_cat_name + html_cat_img + html_cat_click + '</div>');

      //

      function getActiveLink() {
        return $('ul#catNameList li.active').index();
      }

      //

      function getCatNameList(cats) {
        var catNames = [];
        for (kitten in cats) {
          catNames[kitten] = cats[kitten].getName();
        }
        return catNames;
      }

      function displayCatNameList(cats) {
        var catNames = getCatNameList(cats);
        for (var name in catNames) {
          var elem = document.createElement('li');
          elem.textContent = catNames[name];
          $("#catNameList").append(elem);
          $('#catNameList').find('li:first').addClass('active');
        } 
      }

      function displayCurrentCat(cat, num) {
        var element = document.getElementById("catshow"),
            catNode = element.firstChild.childNodes;
        element.childNodes[0].id = num;
        catNode[0].innerHTML = cat.getName();
        catNode[1].src = cat.getImgUrl();
        catNode[2].innerHTML = 'Strokes: ' + cat.getClicks();
      }

      //

      var Kitten = function(kitten) {
        this.name = kitten.name;
        this.img = kitten.img;
        this.clicks = 0;
      };

      Kitten.prototype.getName = function() {
        return this.name;
      }

      Kitten.prototype.getImgUrl = function() {
        return this.img;
      }

      Kitten.prototype.getClicks = function() {
        return this.clicks;
      }

      Kitten.prototype.stroke = function() {
        this.clicks += 1;
      };

      Kitten.prototype.display = function() {
        var element = document.getElementById("catshow"),
            catNodes = element.firstChild.childNodes;
        catNodes[2].innerHTML = 'Strokes: ' + this.clicks;
      };

      Kitten.prototype.update = function() {
        this.display();
      };

      //

      var initKittens = function(cats) {
        var allKittens = [];
        for (kitten in cats.kittens) {
          allKittens.push(new Kitten(cats.kittens[kitten]));
        }
        return allKittens;
      };

      var allKittens = initKittens(cats);
      displayCatNameList(allKittens);

      var currentCatId = getActiveLink();
      displayCurrentCat(allKittens[currentCatId], currentCatId);

      //

      $('#catNameList').on('click','li', function(){
         $(this).addClass('active').siblings().removeClass('active');

         var currentCatId = getActiveLink();
         displayCurrentCat(allKittens[currentCatId], currentCatId);
       });

      $('.clicker').click(function() {
        var imageClicked = document.getElementById(this.parentNode.id),
            currentCatId = imageClicked.id,
            currentCat = allKittens[currentCatId];
        currentCat.stroke();
        currentCat.update();
      });

  </script>
  </body>
</html>
